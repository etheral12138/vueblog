---
title: 操作系统
date: 2023-03-16
icon: linux
category:
- 计算机基础
tag:
- 计算机基础
---





## 进程管理

### 锁

#### 互斥锁与自旋锁

自旋锁是最比较简单的一种锁，一直自旋，利用 CPU 周期，直到锁可用。

**如果你能确定被锁住的代码执行时间很短，就不应该用互斥锁，而应该选用自旋锁，否则使用互斥锁。**

#### 读写锁

如果只读取共享资源用「读锁」加锁，如果要修改共享资源则用「写锁」加锁。

写锁是独占锁，因为任何时刻只能有一个线程持有写锁，类似互斥锁和自旋锁，而读锁是共享锁，因为读锁可以被多个线程同时持有。

**读写锁在读多写少的场景，能发挥出优势**

#### 乐观锁与悲观锁



## 文件系统

Linux 文件系统会为每个文件分配两个数据结构：**索引节点和目录项**，它们主要用来记录文件的元信息和目录层次结构。

文件系统首先要先挂载到某个目录才可以正常使用，比如 Linux 系统在启动时，会把文件系统挂载到根目录。

**文件系统的基本操作单位是数据块**。

传输文件的时候，我们要根据文件的大小来使用不同的方式：

- 传输大文件的时候，使用「异步 I/O + 直接 I/O」

- 传输小文件的时候，则使用「零拷贝技术」

零拷贝技术是基于 PageCache 的，PageCache 会缓存最近访问的数据，提升了访问缓存数据的性能，同时，为了解决机械硬盘寻址慢的问题，它还协助 I/O 调度算法实现了 IO 合并与预读，这也是顺序读比随机读性能好的原因。这些优势，进一步提升了零拷贝的性能。

另外，当传输大文件时，不能使用零拷贝，因为可能由于 PageCache 被大文件占据，而导致「热点」小文件无法利用到 PageCache，并且大文件的缓存命中率不高，这时就需要使用「异步 IO + 直接 IO 」的方式。

## 设备管理